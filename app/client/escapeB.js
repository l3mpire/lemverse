Template.escapeB.onCreated(() => {
  Meteor.call('currentLevel', (err, result) => {
    if (err) return;
    Session.set('currentLevel', result);
  });
});

const computeDuration = () => {
  const currentLevel = Session.get('currentLevel');
  const start = currentLevel.metadata?.start || 0;
  const end = currentLevel.metadata?.end || 0;
  const res = ((end - start) / (60 * 60)) | 0;
  return res;
};

Template.escapeB.helpers({
  iframe() {
    return FlowRouter.current().queryParams.n;
  },
  duration() {
    computeDuration();
  },
  youWin() {
    const currentLevel = Session.get('currentLevel');
    if (currentLevel.metadata?.end) return false;
    return computeDuration() < 60; // 60 minutes
  },
});

const chest = () => {
  const snd = new Audio('data:audio/mpeg;base64,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Qzn5fq05YaxENf+UmUFHI//7nc1kOk1Rr9I16GjGoJyzDBQg4lplTEFNRTP/80Bk7ggtHwQABGaogAADSAAAAAAuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRf/zQmTsCCDy9AAEAyCAAANIAAAAADMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQGTsB/EagAEMI8CAAANIAAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//NCZKsAAAAAAAAAAAAAA0gAAAAAVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV');
  snd.play();
};

const click = () => {
  const snd = new Audio('data:audio/wav;base64,UklGRuodAABXQVZFZm10IBAAAAABAAEAgD4AAIA+AAABAAgATElTVBoAAABJTkZPSVNGVA4AAABMYXZmNTguMzMuMTAwAGRhdGGkHQAAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAf4B/gX2DeYx+h5B9lG+Ud4iFe2lzjHRifH59cIZwf5uFfY6PjIuOfnx+inh0eXh5a3p4e318gISBhoSBiYeBgoaDgYOAgoB8foGBgHl9gnt8fYB+fn5+goaDgoWGhISFhYGCgH6Afnx9fX59fn9/gYGBgYOEgYKDgYGBgIGBgIB/gIB/f39/f4B/f4B/gIGAgICBgYCAgICAgH9/f39/gICAgICAgYGAgICAf39/f35/f39/gICAgYGBgYGBgICAf39/fn9+fn5/f3+AgICBgYGBgYGBgICAgIB/gH9/gH9/gICAgICAgICAgIGBgYGBgICBgICAgIB/gH9/gICAgICAgYGBgYGBgIGAgICAgICAgH+AgICAgICAgICAgYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGAgYCDc4F0e3l1jXqJd3uKippxn3Z8hX2fZ4x3ZopygnKGfGuSfoqPe36FjoOSgHmAe4Z4e357gHx8fXmJhn+DfICGg4GCfXuBgYB/g39/fX+DgYaAeX5/fYKAfH18f3+Cgn+Egn+BgoKAgIB9f4F+foB/f4B/goGAgICBgYCAf39/gIF/gH9/gYGAgICBgX+AgYCBgYCAgICBgICAf39/f39/f4CAgICBgoGCgoKCgYGAgIB/f39+fn9/gICAgIGBgYGCgoKCgYCAgICAf39/f3+Af39/gICAgICAgYGBgYGBgIGAgIB/gH+Af39/f4CAgICAgYCAgYGBgICAgICAgH9/f3+Af4B/gICAgICBgIGAgYCAgICAgIB/gICAf4CAgICAgICAgIGAgICAgICAgH+Af4CAf4CAgICAgICAgICAgICAgICAgICAgICAgH+AgICAgICAgICAgICAgIGAgICAgICAgICAgICAgICAgICAgICAgICBgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgICAgICAgICAgICAgICAgICAgICAgICBgICAgICAgICAgICAgICAgICAgIGAgYCAgICBgICAf4CAf4B/f4B/gICAgICAgICBgICAgICAgICAgICAf4CAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgA==');
  snd.play();
};

const beep = () => {
  const snd = new Audio('data:audio/wav;base64,//uQRAAAAWMSLwUIYAAsYkXgoQwAEaYLWfkWgAI0wWs/ItAAAGDgYtAgAyN+QWaAAihwMWm4G8QQRDiMcCBcH3Cc+CDv/7xA4Tvh9Rz/y8QADBwMWgQAZG/ILNAARQ4GLTcDeIIIhxGOBAuD7hOfBB3/94gcJ3w+o5/5eIAIAAAVwWgQAVQ2ORaIQwEMAJiDg95G4nQL7mQVWI6GwRcfsZAcsKkJvxgxEjzFUgfHoSQ9Qq7KNwqHwuB13MA4a1q/DmBrHgPcmjiGoh//EwC5nGPEmS4RcfkVKOhJf+WOgoxJclFz3kgn//dBA+ya1GhurNn8zb//9NNutNuhz31f////9vt///z+IdAEAAAK4LQIAKobHItEIYCGAExBwe8jcToF9zIKrEdDYIuP2MgOWFSE34wYiR5iqQPj0JIeoVdlG4VD4XA67mAcNa1fhzA1jwHuTRxDUQ//iYBczjHiTJcIuPyKlHQkv/LHQUYkuSi57yQT//uggfZNajQ3Vmz+Zt//+mm3Wm3Q576v////+32///5/EOgAAADVghQAAAAA//uQZAUAB1WI0PZugAAAAAoQwAAAEk3nRd2qAAAAACiDgAAAAAAABCqEEQRLCgwpBGMlJkIz8jKhGvj4k6jzRnqasNKIeoh5gI7BJaC1A1AoNBjJgbyApVS4IDlZgDU5WUAxEKDNmmALHzZp0Fkz1FMTmGFl1FMEyodIavcCAUHDWrKAIA4aa2oCgILEBupZgHvAhEBcZ6joQBxS76AgccrFlczBvKLC0QI2cBoCFvfTDAo7eoOQInqDPBtvrDEZBNYN5xwNwxQRfw8ZQ5wQVLvO8OYU+mHvFLlDh05Mdg7BT6YrRPpCBznMB2r//xKJjyyOh+cImr2/4doscwD6neZjuZR4AgAABYAAAABy1xcdQtxYBYYZdifkUDgzzXaXn98Z0oi9ILU5mBjFANmRwlVJ3/6jYDAmxaiDG3/6xjQQCCKkRb/6kg/wW+kSJ5//rLobkLSiKmqP/0ikJuDaSaSf/6JiLYLEYnW/+kXg1WRVJL/9EmQ1YZIsv/6Qzwy5qk7/+tEU0nkls3/zIUMPKNX/6yZLf+kFgAfgGyLFAUwY//uQZAUABcd5UiNPVXAAAApAAAAAE0VZQKw9ISAAACgAAAAAVQIygIElVrFkBS+Jhi+EAuu+lKAkYUEIsmEAEoMeDmCETMvfSHTGkF5RWH7kz/ESHWPAq/kcCRhqBtMdokPdM7vil7RG98A2sc7zO6ZvTdM7pmOUAZTnJW+NXxqmd41dqJ6mLTXxrPpnV8avaIf5SvL7pndPvPpndJR9Kuu8fePvuiuhorgWjp7Mf/PRjxcFCPDkW31srioCExivv9lcwKEaHsf/7ow2Fl1T/9RkXgEhYElAoCLFtMArxwivDJJ+bR1HTKJdlEoTELCIqgEwVGSQ+hIm0NbK8WXcTEI0UPoa2NbG4y2K00JEWbZavJXkYaqo9CRHS55FcZTjKEk3NKoCYUnSQ0rWxrZbFKbKIhOKPZe1cJKzZSaQrIyULHDZmV5K4xySsDRKWOruanGtjLJXFEmwaIbDLX0hIPBUQPVFVkQkDoUNfSoDgQGKPekoxeGzA4DUvnn4bxzcZrtJyipKfPNy5w+9lnXwgqsiyHNeSVpemw4bWb9psYeq//uQZBoABQt4yMVxYAIAAAkQoAAAHvYpL5m6AAgAACXDAAAAD59jblTirQe9upFsmZbpMudy7Lz1X1DYsxOOSWpfPqNX2WqktK0DMvuGwlbNj44TleLPQ+Gsfb+GOWOKJoIrWb3cIMeeON6lz2umTqMXV8Mj30yWPpjoSa9ujK8SyeJP5y5mOW1D6hvLepeveEAEDo0mgCRClOEgANv3B9a6fikgUSu/DmAMATrGx7nng5p5iimPNZsfQLYB2sDLIkzRKZOHGAaUyDcpFBSLG9MCQALgAIgQs2YunOszLSAyQYPVC2YdGGeHD2dTdJk1pAHGAWDjnkcLKFymS3RQZTInzySoBwMG0QueC3gMsCEYxUqlrcxK6k1LQQcsmyYeQPdC2YfuGPASCBkcVMQQqpVJshui1tkXQJQV0OXGAZMXSOEEBRirXbVRQW7ugq7IM7rPWSZyDlM3IuNEkxzCOJ0ny2ThNkyRai1b6ev//3dzNGzNb//4uAvHT5sURcZCFcuKLhOFs8mLAAEAt4UWAAIABAAAAAB4qbHo0tIjVkUU//uQZAwABfSFz3ZqQAAAAAngwAAAE1HjMp2qAAAAACZDgAAAD5UkTE1UgZEUExqYynN1qZvqIOREEFmBcJQkwdxiFtw0qEOkGYfRDifBui9MQg4QAHAqWtAWHoCxu1Yf4VfWLPIM2mHDFsbQEVGwyqQoQcwnfHeIkNt9YnkiaS1oizycqJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=');
  snd.play();
};

const buzz = () => {
  const snd = new Audio('data:audio/wav;base64,UklGRqYTAABXQVZFZm10IBAAAAABAAEAgD4AAIA+AAABAAgATElTVBoAAABJTkZPSVNGVA4AAABMYXZmNTguMzMuMTAwAGRhdGFgEwAAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIB/fXp3gZmpkmBLWICrmn2FiIBqWX+rpo1tYnFwb3+Tp5h2cnZ0dn2UnINvZ22DiYeQlpV8WGF7hYmOmn9TfcagOTCS2rRPH3Plz1UfZ6+LN1XO5aBjW5GcaEVVe4mAgJelkoSKi4BtaHF1cXSGkYuIioyKgHZ3fXl0eH+FhYWGhYSDf3p4eH+Vo4lcUGGGqpmBh4V+aVqDqaGKa2JycXSElqiWdHFzcnV+lZqBb2hwh4uJkZWUeFdke4SJjph7VIbKmjQ0mtqrRyF/6sdNIm+xhDRd1eCZXl2VmmRGWH6Jf4GYpI+Diop+bGlzdnF1iZGLh4mLiX92eX14dHiAhYWGh4SDgn99f396dXJ9ma+XYElbhquVe4eJf2dXgKukjG9ndnBuf5OllXRyd3R1fZWcg3Bpb4SHhI+Xl3tXYXqDiZCcgFWAxZo0MJbcsk0geOfLUiBqsIczVtDjn2JdlJxmRVZ9iX+Al6WRg4mLgG5pcnZxdIaQioaJjYuAdnh9eXR4gYWDg4WFhIOAfoGBe3VydYqpq3xOT2uZqYiAioR1WmKYrpyBZmpzbnmJnKSFcHVzcneHnZN5bGl4iYeKk5eNZlVugImNlpZmWaTFbiNWv9aHKziy75krNJKtYC+M6sqBVnKih1JGZoaGfYegnoiGjYl4amx0c296jY+JiY2Ohnl0e312dHuDhYSGhoWEgX5+gHx1cXqUq5xoSVSBrpx7hYqAalV5qqeObmJ0c3CAk6WXdXB2c3R7k56HcWhtg4qGj5WWf1lfeYOIjpqDVXjEpz8ritm6Vh5q4dVdHl+ukjtNxealZlmOn2xHU3mJgH+UpZODiYyCb2hxdnN0hZCKhomNjIF2dn16dXd/hYWFhoWDgn99gIJ9dnJ0h6atglFOaJSqi36KhnhdXpKsnYRoanVudoaZpIlxdXNydoWdl3xtZ3OGhoqVmZBrVWt+houUmGxVnMh6JUu325MxLqPwpzMtiK9pLX7m0YhYbKCMVkZjhId9hZ2giYWNinprbHV1cHiKjoiIjI6IfHV7fXd0eoGEhIWGhIOCf3+AfXZxeJCqoG1KUnusoHyDi4JtVXOmqZFyYXJ0b36RpJx5cHZzc3mQn4lyaWuAiYaPl5iCWlt3g4eNmolYb76wSSd+1cNiHlvW3mwgVaiYQUK56q9tV4ehckhPdoqCfpCjlYSJjYVyaG91cnKCkIuGiIyMg3h3fXt1dn2DhIWGhYSCgH6Agn13cnKDo6+IVE1kkKuPfYmGel9bjayfhmpodW91hZeljXJ0dHF1g5uafm5ncYWHiZSZkm9UaH2Gi5OaclKRyIYqQ63cnTgmlO+1Pih/sHMucOHZkFplnJFbRl+CiH6Dm6GKhI2MfGpqdHZwd4qPiYeKjYl9dnp+eHR5gIOEhoeFg4J/f4F+d3F2jKejc01QdamlfoGLg3FWbKKrlXZhcHZvfI6in3xvdXNzeI2fjXRqaX2Kho2WmIZdWHWDiIyZjltnt7hVJXHPyW0gTs3neiFKo6FKOqzst3JVgKJ5S01yioN9jaKYhIiNhnRobnZ0coCPjIaIjIyEeXd9e3V1fIOEhIaGhIOAfn+BfXZxdY2qp3RMUXSkpYGBioNxV2uhq5Z5ZG90bnyNoJ99cHZzcniNoI92aml7iIWNlpmIX1hzgoiMmJBeYrK7WiRrzM1zIUjG6YIjRZ+jTzel7Lt1VX2ifExMcIiDfoyimYSHjYd0aG52dHF/joyGiIyNhXl2fHx2dnyChISGhoSDgH6Agn54c3F+nrGSWktfiKuWfYeIfGRXg6ykjG1ldHFzgpOlk3NydHF1f5edhHBnboSJiJKXlHZVY3yFipCbfFKDyJkzNJvcrUcfferJTSFusYQyW9TinGBelZlkRll/iX+AlqOPhIyNgG1pcnZxdIePioeKjYp/dnl9eXR4f4SEhYeFg4KAfoB/eHF0iKSofVFNbaKrg36KhHVZZJusmXxjbndveoufoYFudXRzdomfk3draHmJhouVmIxkVnCBh4qWlGNdq8JnI17E038mPLnukSk7l6pZMpXqw3xVdaKDUElriIV9iaCchoaNiHdpbHV0cX2NjYeHjI2HenV7fXZ1e4KFhYaGhIOBfn+Cf3hzcXyasJhgSluCqZp9hoh+aFZ8qaeQcWVzcXGAkaOXdnJ1cXR9lZ+HcWdrgYmHkZeWe1dgeYSKj5uCU3jEpT0tjdq4Uh1t49RcH2KujjhOyOelZVqPnWpHVHqJgH+To5KDio2Cb2hxdnJzhI+Kh4qNi4F2d316dHd+g4SFh4WDgoB+gH95cnOEoaqDU0tnnK6HfIqGeFtfla6cgGRrd3B4iZ2khW90dHN1hZ6WemxndomHipSYj2hUbYCGipSXaVihx3QlUbrXjC0xqvGhMDKOrmQvhujMhFZvoYpUR2eHhn2Gnp6IhY2KeWprdHRxe4yOh4eLjoh7dXt9d3R6goWEhoaFhIF+foGAeXRxepavnmZKWX2nnn6EiX9rVXWnqJJ1ZXJzcH+Oopp4cXVxc3ySoIpzaGp+iYeQl5eAWl13g4mOmohWb7+vRyiA1sFeHV7Z3mofVqmXQEO76q1rV4igcUlRdomCfpCjlISKjoRwaHB2cnKCj4uHiY2Mgnd3fXt1dn2DhIWHhYOCgH6AgHpzcoGdq4pYSmKWsIx7iYd6XlqOrZ+EZmh3cXaHmqWKb3N0cnWDnJl9bWdziIeJk5eRbVNqf4aJk5lwVZjJgShGr9qYNSqb8K84K4SxcC534tSLWWiekFlFYYWIfoScoIqEjIt8a2pzdXF5i46Ih4uOiX11en13dHmBhYSFhoWEgX5+gX94cnKBoK6MV0tjkq2OfImGemBajK2ghmlpdm91hpikjHF0dXF1gpuaf25ncoaHiJOYk3BUaH6GipKac1SRyIcrQqvbnjomk++2Pih+sXUvb9/YkFtlnJJcRV+DiH6Dm6GLhIyLfWtqdHZxd4qPiIeLjop9dXl+eHR5gYSEhYeFg4J/f4GAenVxdpCtpXBLVHWipYKBioJwVmuhrJd6ZG91cHuLn599b3Vyc3mNoJB2aWh7iYeNlpeGXll0gomMmJBdY7S8WSJrzc1yIUnI6oEiRaCjTTam7bt1VX6je0xLcImDfYuimYWIjod0aG52c3F+jo2HiY2NhHl2fHt1dXyDhISHhoSDgX5/gHt0cX2ZrJNfSlyNsZR6h4h9ZFaErKOJamZ3cnOElqWQcXJ1cnR/mZyBb2hwhYiHkpeVdlRkfYWIkJp6VIjJlTI3ndupRCGC68RKI3KxgTJg1t6YX1+XmGJFWoCJf4GYoo6Di4x/bWlydnF2iI+JhoqOi391eH55dHiAhYWFhoWDgn5+gYF7dXF1jKqpd05Sb52nhYCKg3NYZZusmn9mbXVveYmcoYJwdXJyeIqfk3hrZ3eIh4yWmIpjV3CBiIyXlGNcq8JmIl7F1H8mPLrvkSg7l6pYMZXrxHxVdqKDUElrh4V9iKGchoaOiHZpbXZ0cHyNjYeIjI2GenV7fHZ1e4KEhIaGhIOBfn+AfHVxe5WrmWRKWIawmXuFiX9oVX2qpo1tY3VzcoKTpZV0cHVydHyVnoVxaG2DiYeQl5Z7VmB7hIiOm4FUfcahOy+Q2bRQHnHl0VcgZq+MN1LL5KFjW5GdaEZVfYqAf5SjkYOKjYJvaXF2cnSGj4qHio2MgXZ4fXp0d3+EhYWGhYSCf32Agnx2cXOIqKx+UFBrmKqJfomEdltglq2cgmdsdW94h5qjhnB1c3J3h56WemxndYeHi5WYjmhVbX+Hi5WXaVegx3QkUbvYiywyqvGhMDKOrmQuhejNhFZvoYlVR2aGhn2Gnp6Iho2KeGlsdXVweoyOiIiMjoh7dXt9d3V6gYSEhoaEg4F/f4F9dnF4kamea0tUf66ffISKgWtUdaeokXFjdHVxgJGkmXZvdXJzepKfiXJpa4GKho+Wl4BYXXmEiI2ah1ZzwaxFKYLWvlwdYtzbZh9aq5Y+Rr/oqmlYiqBvR1F4ioF+kaOUg4mNhHFocHZyc4OPi4aJjYyCd3d9enR2foSFhYaGhIN/fYCBfHVxeJKsoGtKVXypn36EioFsVXOmqJJ0ZHJzb3+Popp4cXZyc3qRoItzaWp+iIaPl5iDWlt3g4iNmopYbrywSid91MNiHlrW4G4gVKiaQkK46q9tVoehc0lQdomCfpCjlYOIjYRxaHB2c3KCj4uGiY2Ng3d2fXt1dn6DhISGhoSDgH6Agn13cnKCoq+JVU1kkKyQfYmGeV9ai62hh2lodnB1hJaljXFzdHJ2gpubf25mcYaIiZOYkm9UaH6GipKac1ORyokqP6rcnzolkvC3Pid9snUtbd/ZkVtlnJNcRV6CiH6CmqKMhIyMfWtqc3VwdomPiYiLjol9dnp9d3R5gISEhoeFg4J/f4B+d3F1jKekdE1QdKimf4CKg3FWa6GrlXdicXZvfI6hnnxvdXNzeI2gjnRqaX2Kho2WmIdeWHSCh4uYj11mtrpXJG7Ny28gS8rofiJIoaJMOanruHNVf6N7TExxiYN9jKKYhYeNhnRobnZ0coCOjIeIjI2FeHZ8fHV1fIOFhYaGhIOAfn+CfndzcX+esJBaS2CJq5R9h4d8Y1eErKOMbWd1cHOCk6SSc3N0cXWAmJ2Db2dug4iIk5iUdVVkfIWKkZt7UoXIljI2ndyrRSCB68ZLInCxgTFe1uCaX1+WmGJGWX+Jf4CXo46Ei41/bGlzdnF1h4+Jh4uOi392eH15dHh/g4SFh4WDgoB+gH94cnSIpKd7UE1uo6qDf4uEdFhlnKyZe2Jud3B6i5+igG50c3N3iZ+Sd2toeYqHjJWYi2JWcYKHipaTYl6twWUjYMXSfSU+vO6PJz2ZqVcymOvCe1V3o4JPSWyIhX2JoZuGho2Id2ltdXRxfY6Nh4iMjoZ6dXx8dXR7goWEhoaFhIF+f4J/eHNxfJqwl19LXIOqmX2GiH5nVn2qpo9xZnRxcYGRo5Z1cnVxdH6Wn4ZxaGyBiIeRmJZ7V2B6hIqPm4JTecSjPC6P2rZRHW/j01ofY66NN1DK5qRlWpCdakdVe4mAf5SjkYSLjYFuaXJ2cXOFj4qHio6MgXZ4fXp0d36DhIWHhYOCgH+Af3lyc4ShqYNTTGidrod9ioZ4W16VrZyAZGt4cHiJnaSFbnN0cnaGnpZ6bGd2iYeKlJiPaFRtgYaKlJdpWaLGcyVSu9eLLTKr8J8vM4+uZC6G6MuDVm+hiVRHZ4eGfYaenoiFjIp6amx0dXF7jI6Hh4uOiHt1e312dHqChYSGhoWEgX5+gX93cnOEo62FUkxomKyKfYqFeFxdk62dgmdrdm93iJqjh3B1dHJ1hZ2XfG1ndIeGipSZkWtUa3+GipSYbVabx3onTLbZkjEtovCoNS+Ir2oufuXQiFhrn41WRmSFh36Fnp+IhIyKemprdXVxeYuOh4eLjol8dXp9d3R6gYSEhoeFg4F/f4GAeXRxeJSvoGlKV3qmoYCDiYBsVXGlqpR2ZHF0cH2NoZ16cHVyc3qQoIx0aGl9iYeOlpeCW1t2g4mNmYtYary1TiV408ZmHlXU43IfUKecRD2z7LNuVoSidUpOdImCfY6jl4SJjoVyaG92c3GBj4yHiY2Mg3h3fXt1dn2DhIWHhoSCgH6AgHpzcYCcq41aSmCSsI97iIh7YFmLraCGaGd3cXWGmKWMcHN1cnSBm5p+bWdyh4iIk5iTcVRnfoWIkZp0VJHJiixAqNufOyWQ7rhAJ3yxdy9t3diRW2SblF1FXoKIfoOaoYuEjIt9a2pzdnF3iY+Ih4qOin51eX14dHiAhYSFhoWDgn5+gYF7dXF2j6ymcUxUdKGlg4GKgnFWaqCrmHtlb3Rve4ufoH5wdXJzeY2gkHZqZ3qJh46WmIdfWHOBiIyYkV1hsr1bI2nMznQhRsbrhCNDnqRPNaPtvXZVfKN9TUtviIR9i6KahYeOh3RobnZzcH6OjIeJjY2FeXZ8fHV1fIKEhIeGhIOBfn+Ae3RxfZirlGBJW4uwlXqHiX5lVoKspIpqZXZyc4SWppJycXVydH6YnYJvaG+FiYiSl5V3VGN9hYiPm3xThciYNDWa2qxHIH7qyE0ib7GDM1zU4JpgXpWZY0VZf4l/gJejj4OLjIBtaXJ2cXWHj4mHio2Lf3Z4fXl0d3+EhIWGhYSCf32AgXt1cXWLqqp5TlFunKiGf4qDdFlkmq2af2ZtdW96iZyig3B1cnJ4iqCUeGtnd4iHjJaYjGRWcIGIjJaVZFupxGkiW8PVgSY5t/CUKTiWq1ovk+zGfVV0ooRRSGqHhX2IoJyGho6IdmhtdnRwfI2Nh4iMjoZ5dXt9dnV7goSEhoaEg4F/f4GAe3p5e4KHhX5/hYV/foCBgH18fX+AgICBhISDgoF/fn59fn9+f4KCgoKBgICAgIGAgH99f4GAf4CBgYCAgIGBf35/gYB/f4CCgoCAgIF/fn5/gYGAgIGBgIGBgQ==');
  snd.play();
};

Template.escapeB.events({
  'click .js-key-code'(e) {
    const { lock, code } = e.currentTarget.dataset;
    const lockString = `lock${lock}`;
    beep();

    const currentLevel = Session.get('currentLevel');
    if (code === 'VALIDATE') {
      if (Session.get(lockString) === currentLevel.metadata[lockString].code) {
        // Success
        Meteor.call('enlightenZone', currentLevel.metadata[lockString].zone);
      } else {
        // Failure
        buzz();
        document.querySelector('#redLed').classList.remove('hide');
        setTimeout(() => {
          document.querySelector('#redLed').classList.add('hide');
        }, 3000);
      }
      Session.set(lockString, '');
    } else if (code === 'CLEAR') {
      Session.set(lockString, '');
    } else {
      Session.set(lockString, `${Session.get(lockString) || ''}${code}`);
    }
  },
  'click .js-activate-switch'(e) {
    const { zone } = e.currentTarget.dataset;
    if (!zone) return;
    click();
    Meteor.call('toggleZone', zone);
  },
});

Template.registerHelper('isEscapeLevel', () => {
  const level = Session.get('currentLevel');
  if (!level) return false;
  return level.metadata?.escape;
});

Template.registerHelper('gameStarted', () => {
  const level = Session.get('currentLevel');
  if (!level) return false;
  return level.metadata?.start;
});

Template.escapeTimer.onCreated(() => {
  const animationTime = 60 * 60;
  const minutes = 60;

  $(document).ready(() => {
    // timer arguments:
    //   #1 - time of animation in mileseconds,
    //   #2 - days to deadline

    $('#progress-time-fill, #death-group').css({ 'animation-duration': `${animationTime}s` });

    const deadlineAnimation = function () {
      setTimeout(() => {
        $('#designer-arm-grop').css({ 'animation-duration': '1.5s' });
      }, 0);

      setTimeout(() => {
        $('#designer-arm-grop').css({ 'animation-duration': '1s' });
      }, animationTime * 0.3 * 1000);

      setTimeout(() => {
        $('#designer-arm-grop').css({ 'animation-duration': '0.7s' });
      }, animationTime * 0.6 * 1000);

      setTimeout(() => {
        $('#designer-arm-grop').css({ 'animation-duration': '0.3s' });
      }, animationTime * 0.7 * 1000);

      setTimeout(() => {
        $('#designer-arm-grop').css({ 'animation-duration': '0.2s' });
      }, animationTime * 0.85 * 1000);
    };

    function timer(totalTime, deadline) {
      const time = totalTime * 1000;
      const dayDuration = time / deadline;
      let actualDay = deadline;

      // eslint-disable-next-line no-use-before-define
      const interval = setInterval(countTime, dayDuration);

      function countTime() {
        --actualDay;
        $('.deadline-days .day').text(actualDay);

        if (actualDay === 0) {
          clearInterval(interval);
          $('.deadline-days .day').text(deadline);
        }
      }
    }

    const deadlineText = function () {
      const $el = $('.deadline-days');
      const html = `<div class="mask-red"><div class="inner">${$el.html()}</div></div><div class="mask-white"><div class="inner">${$el.html()}</div></div>`;
      $el.html(html);
    };

    deadlineText();

    deadlineAnimation();
    timer(animationTime, minutes);

    setInterval(() => {
      timer(animationTime, minutes);
      deadlineAnimation();
    }, animationTime * 1000);
  });
});
